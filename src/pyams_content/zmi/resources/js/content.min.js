"use strict";void 0===window.$&&(window.$=MyAMS.$);const content={tree:{switchVisibleElement:(e,t)=>{const a=t.node_id,s=$(`tr[data-ams-tree-node-id="${a}"]`),i=$(s.parents("table")),n=$("thead",i),r=$('th[data-ams-column-name="visible"]',n),o=r.index(),c=$("i",$(`td:nth-child(${o+1})`,s)),m=$(`[data-ams-tree-node-id="${s.data("ams-tree-node-parent-id")}"]`);let l;if("TR"===m.get(0).tagName){l=$("i",$(`td:nth-child(${o+1})`,m)).attr("class")}else l=i.data("ams-visible")?"":"text-danger";!0===t.state?c.replaceWith(`<i class="${r.data("ams-icon-on")} ${l}"></i>`):c.replaceWith(`<i class="${r.data("ams-icon-off")} ${l}"></i>`)}},widget:{treeview:{selectFolder:(e,t)=>{$(e.target).siblings('input[type="hidden"]').val(t.id)},unselectFolder:(e,t)=>{$(e.target).siblings('input[type="hidden"]').val(null)}}},pictograms:{initManagerSelection:function(){const e=$(this),t=$('input[type="hidden"]',$(".selected-pictograms",e)).listattr("value");return{selected:JSON.stringify(t)}},switchPictogram:e=>{$("i",e.currentTarget).tooltip("hide");let t=$(e.currentTarget);t.hasClass("pictogram")||(t=t.parents(".pictogram"));const a=$("input",t),s=t.parents(".pictograms"),i=s.parents(".pictograms-manager");if(s.hasClass("available-pictograms")){const e=a.attr("data-ams-pictogram-name");a.removeAttr("data-ams-pictogram-name").attr("name",e),$("a.action i",t).replaceWith($("<i></i>").addClass("fa fa-fw fa-arrow-left hint opaque baseline").attr("data-ams-hint-gravity","se").attr("data-ams-hint-offset","3")),$(".selected-pictograms",i).append(t)}else{const e=a.attr("name");a.removeAttr("name").attr("data-ams-pictogram-name",e),$("a.action i",t).replaceWith($("<i></i>").addClass("fa fa-fw fa-arrow-right hint opaque baseline").attr("data-ams-hint-gravity","se").attr("data-ams-hint-offset","3")),$(".available-pictograms",i).append(t)}},endDrag:(e,t)=>{$(t.source).remove()}},review:{timer:null,interval:3e4,init:()=>{$(document).off("update-comments.ams.content").on("update-comments.ams.content",(e,{count:t})=>{const a=$('a[href="#review-comments.html"]',$("nav"));a.exists()&&$(".badge",a).text(t)});const e=MyAMS.content.review;e.timer=setTimeout(e.getComments,e.interval)},initPage:()=>{MyAMS.require("helpers").then(()=>{const e=$("#review-messages-view"),t=$("li",e).last();e.exists()&&MyAMS.helpers.scrollTo(e,t)})},getComments:()=>{MyAMS.require("ajax","helpers").then(()=>{const e=MyAMS.content.review,t=$('a[href="#review-comments.html"]',$("nav")),a=$(".badge",t);MyAMS.ajax.get("get-comments.json",{count:a.text()||"0"}).then(({status:t,comments:s,count:i},n,r)=>{if(i!==parseInt(a.text())&&(a.removeClass("bg-info").addClass("bg-danger scaled"),a.text(i),setTimeout(()=>{a.removeClass("bg-danger scaled").addClass("bg-info")},1e4)),s){const e=$("#review-messages-view"),t=$("#review-messages");for(const e of s)t.append($(e));MyAMS.helpers.scrollTo(e,$("li",t).last())}e.timer=setTimeout(e.getComments,e.interval)})})}}};window.MyAMS&&(MyAMS.config.modules.push("content"),MyAMS.content=content,console.debug("MyAMS: content module loaded..."));
